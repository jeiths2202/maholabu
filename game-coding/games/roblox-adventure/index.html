<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title data-i18n="roblox_adventure_title">3D 로블록스 어드벤처</title>
    <link rel="stylesheet" href="css/roblox-adventure.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script src="../../../static-content/i18n.js"></script>
    <script src="../../../static-content/game-i18n.js"></script>
</head>
<body>
    <div class="game-container">
        <!-- Game Header -->
        <header class="game-header">
            <div class="game-title">
                <h1 data-i18n="roblox_adventure_title">3D 로블록스 어드벤처</h1>
                <div class="level-indicator">
                    <span data-i18n="level">레벨</span>: <span id="current-level">1</span>/10
                </div>
            </div>
            <div class="game-stats">
                <div class="score">
                    <span data-i18n="score">점수</span>: <span id="current-score">0</span>
                </div>
                <div class="progress-bar">
                    <div class="progress-fill" id="level-progress"></div>
                </div>
            </div>
        </header>

        <!-- Main Game Area -->
        <main class="game-main">
            <!-- 3D World Container -->
            <div class="world-container">
                <canvas id="game-canvas"></canvas>
                <div class="world-overlay">
                    <div class="character-info" id="character-info">
                        <div class="character-avatar">🤖</div>
                        <div class="character-name" data-i18n="robot_name">로봇</div>
                    </div>
                    <div class="objective" id="current-objective">
                        <h3 data-i18n="objective">목표</h3>
                        <p id="objective-text">보물상자에 도달하세요!</p>
                    </div>
                </div>
            </div>

            <!-- Coding Puzzle Panel -->
            <div class="coding-panel">
                <div class="panel-header">
                    <h2 data-i18n="coding_blocks">코딩 블록</h2>
                    <button class="help-button" onclick="showHelp()" data-i18n="help">도움말</button>
                </div>
                
                <!-- Block Palette -->
                <div class="block-palette">
                    <div class="block-category">
                        <h3 data-i18n="movement">이동</h3>
                        <div class="block" data-block-type="move-forward" draggable="true">
                            <span class="block-icon">➡️</span>
                            <span class="block-text" data-i18n="move_forward">앞으로 이동</span>
                        </div>
                        <div class="block" data-block-type="turn-left" draggable="true">
                            <span class="block-icon">↪️</span>
                            <span class="block-text" data-i18n="turn_left">왼쪽 회전</span>
                        </div>
                        <div class="block" data-block-type="turn-right" draggable="true">
                            <span class="block-icon">↩️</span>
                            <span class="block-text" data-i18n="turn_right">오른쪽 회전</span>
                        </div>
                    </div>
                    
                    <div class="block-category">
                        <h3 data-i18n="loops">반복</h3>
                        <div class="block loop-block" data-block-type="repeat" draggable="true">
                            <span class="block-icon">🔄</span>
                            <span class="block-text" data-i18n="repeat">반복</span>
                            <input type="number" class="repeat-count" value="2" min="1" max="10">
                        </div>
                    </div>
                    
                    <div class="block-category">
                        <h3 data-i18n="conditions">조건</h3>
                        <div class="block condition-block" data-block-type="if-wall" draggable="true">
                            <span class="block-icon">🧱</span>
                            <span class="block-text" data-i18n="if_wall">벽이 있으면</span>
                        </div>
                    </div>
                </div>

                <!-- Programming Area -->
                <div class="programming-area">
                    <h3 data-i18n="your_program">당신의 프로그램</h3>
                    <div class="code-workspace" id="code-workspace">
                        <div class="drop-zone" data-i18n="drag_blocks_here">여기에 블록을 드래그하세요</div>
                    </div>
                    <div class="control-buttons">
                        <button class="run-button" onclick="runProgram()" data-i18n="run">실행</button>
                        <button class="reset-button" onclick="resetProgram()" data-i18n="reset">리셋</button>
                        <button class="clear-button" onclick="clearWorkspace()" data-i18n="clear">지우기</button>
                    </div>
                </div>
            </div>
        </main>

        <!-- Game Controls -->
        <div class="game-controls">
            <button class="back-button" onclick="goBackToMenu()" data-i18n="back_to_games">게임 목록으로</button>
            <button class="next-level-button" id="next-level-btn" onclick="nextLevel()" style="display: none;" data-i18n="next_level">다음 레벨</button>
        </div>
    </div>

    <!-- Success Modal -->
    <div class="modal" id="success-modal" style="display: none;">
        <div class="modal-content">
            <h2 data-i18n="level_complete">레벨 완료!</h2>
            <p class="score-display">점수: <span id="level-score">0</span></p>
            <div class="stars" id="star-rating">
                ⭐⭐⭐
            </div>
            <button class="modal-button" onclick="nextLevel()" data-i18n="continue">계속하기</button>
        </div>
    </div>

    <!-- Help Modal -->
    <div class="modal" id="help-modal" style="display: none;">
        <div class="modal-content">
            <h2 data-i18n="how_to_play">게임 방법</h2>
            <div class="help-content">
                <p data-i18n="help_instruction1">1. 왼쪽에서 코딩 블록을 드래그하세요</p>
                <p data-i18n="help_instruction2">2. 프로그래밍 영역에 블록을 배치하세요</p>
                <p data-i18n="help_instruction3">3. 실행 버튼을 눌러 로봇을 움직이세요</p>
                <p data-i18n="help_instruction4">4. 보물상자에 도달하면 레벨 완료!</p>
            </div>
            <button class="modal-button" onclick="closeHelp()" data-i18n="close">닫기</button>
        </div>
    </div>

    <script src="js/roblox-adventure.js"></script>
    <script src="js/3d-world.js"></script>
    <script src="js/block-system.js"></script>
</body>
</html>